<div class="highlight"><pre><span class="kd">var</span> <span class="nx">sjsc</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;sockjs-client-ws&#39;</span><span class="p">);</span>
<span class="kd">var</span> <span class="nx">request</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;request&#39;</span><span class="p">);</span>

<span class="kd">var</span> <span class="nx">client</span> <span class="o">=</span> <span class="nx">sjsc</span><span class="p">.</span><span class="nx">create</span><span class="p">(</span><span class="s2">&quot;http://www.seismicportal.eu/standing_order&quot;</span><span class="p">);</span>
<span class="nx">client</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="s1">&#39;connection&#39;</span><span class="p">,</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;Connected&#39;</span><span class="p">);</span>
<span class="p">});</span>

<span class="nx">client</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="s1">&#39;data&#39;</span><span class="p">,</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">msg</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">message</span> <span class="o">=</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">parse</span><span class="p">(</span><span class="nx">msg</span><span class="p">);</span>
    <span class="kd">var</span> <span class="nx">magnitude</span> <span class="o">=</span> <span class="nx">message</span><span class="p">.</span><span class="nx">data</span><span class="p">.</span><span class="nx">properties</span><span class="p">.</span><span class="nx">mag</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">place</span> <span class="o">=</span> <span class="nx">message</span><span class="p">.</span><span class="nx">data</span><span class="p">.</span><span class="nx">properties</span><span class="p">.</span><span class="nx">flynn_region</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">time</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">Date</span><span class="p">(</span><span class="nb">Date</span><span class="p">.</span><span class="nx">parse</span><span class="p">(</span><span class="nx">message</span><span class="p">.</span><span class="nx">data</span><span class="p">.</span><span class="nx">properties</span><span class="p">.</span><span class="nx">time</span><span class="p">));</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;Earthquake of magintude &#39;</span> <span class="o">+</span> <span class="nx">magnitude</span> <span class="o">+</span> <span class="s2">&quot; in &quot;</span> <span class="o">+</span> <span class="nx">place</span> <span class="o">+</span> <span class="s2">&quot; at &quot;</span> <span class="o">+</span> <span class="nx">time</span><span class="p">);</span>
    <span class="kd">var</span> <span class="nx">options</span> <span class="o">=</span> <span class="p">{</span>
        <span class="nx">method</span><span class="o">:</span> <span class="s1">&#39;POST&#39;</span><span class="p">,</span>
        <span class="nx">url</span><span class="o">:</span> <span class="s1">&#39;https://api.instapush.im/v1/post&#39;</span><span class="p">,</span>
        <span class="nx">headers</span><span class="o">:</span> <span class="p">{</span>
            <span class="s1">&#39;x-instapush-appid&#39;</span><span class="o">:</span> <span class="s2">&quot;MY_APP_ID&quot;</span><span class="p">,</span>
            <span class="s1">&#39;x-instapush-appsecret&#39;</span><span class="o">:</span> <span class="s2">&quot;MY_APP_SECRET&quot;</span><span class="p">,</span>
            <span class="s1">&#39;Content-Type&#39;</span><span class="o">:</span> <span class="s2">&quot;application/json&quot;</span>
        <span class="p">},</span>
        <span class="nx">json</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
        <span class="nx">body</span><span class="o">:</span> <span class="p">{</span> <span class="s1">&#39;event&#39;</span><span class="o">:</span> <span class="s1">&#39;Earthquake&#39;</span><span class="p">,</span> <span class="s1">&#39;trackers&#39;</span><span class="o">:</span> <span class="p">{</span> <span class="s1">&#39;magnitude&#39;</span><span class="o">:</span> <span class="nx">magnitude</span><span class="p">,</span> <span class="s1">&#39;location&#39;</span><span class="o">:</span> <span class="nx">place</span><span class="p">,</span> <span class="s1">&#39;time&#39;</span><span class="o">:</span> <span class="nx">time</span><span class="p">.</span><span class="nx">toLocaleTimeString</span><span class="p">()</span> <span class="p">}</span> <span class="p">}</span>
    <span class="p">};</span>
    <span class="nx">request</span><span class="p">(</span><span class="nx">options</span><span class="p">);</span>
<span class="p">});</span>
<span class="nx">client</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="s1">&#39;error&#39;</span><span class="p">,</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;Some error occured&#39;</span><span class="p">);</span>
<span class="p">});</span>
</pre></div>